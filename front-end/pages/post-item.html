<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n-key="postItem.meta.title">发布物品 - 学生港湾</title>
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/pages/post-item.css">
</head>
<body data-nav-active="browse">
    <!-- 头部导航 -->
    <header id="siteHeader"></header>

    <!-- 主内容 -->
    <main class="main-content">
        <div class="container">
            <div class="page-header">
                <h1 class="page-title" data-i18n-key="postItem.hero.title">发布物品</h1>
                <p class="page-subtitle" data-i18n-key="postItem.hero.subtitle">出售您的二手物品，让它们找到新主人</p>
            </div>

            <div class="post-item-container">
                <form id="postItemForm" class="post-item-form">
                    <!-- 基本信息 -->
                    <div class="form-section">
                        <h2 class="section-title" data-i18n-key="postItem.form.basicInfo">基本信息</h2>
                        
                        <div class="form-group">
                            <label for="category" class="form-label" data-i18n-key="postItem.form.categoryLabel">物品类别 <span class="required">*</span></label>
                            <select id="category" name="category" class="form-control" required>
                                <option value="" data-i18n-key="postItem.form.categoryPlaceholder">请选择类别</option>
                                <option value="TEXTBOOK" data-i18n-key="postItem.category.textbook">📚 教材</option>
                                <option value="ELECTRONICS" data-i18n-key="postItem.category.electronics">💻 电子产品</option>
                                <option value="FURNITURE" data-i18n-key="postItem.category.furniture">🪑 家具</option>
                                <option value="APPAREL" data-i18n-key="postItem.category.apparel">👕 服装</option>
                                <option value="SPORTS" data-i18n-key="postItem.category.sports">⚽ 体育器材</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="title" class="form-label" data-i18n-key="postItem.form.titleLabel">物品标题 <span class="required">*</span></label>
                            <input 
                                type="text" 
                                id="title" 
                                name="title" 
                                class="form-control" 
                                data-i18n-placeholder-key="postItem.form.titlePlaceholder"
                                placeholder="例如：高等数学教材 第3版"
                                required
                                maxlength="100"
                            >
                        </div>

                        <div class="form-group">
                            <label for="description" class="form-label" data-i18n-key="postItem.form.descriptionLabel">详细描述 <span class="required">*</span></label>
                            <textarea 
                                id="description" 
                                name="description" 
                                class="form-control" 
                                rows="6"
                                data-i18n-placeholder-key="postItem.form.descriptionPlaceholder"
                                placeholder="请详细描述物品的状况、使用情况、购买时间等信息..."
                                required
                                maxlength="2000"
                            ></textarea>
                            <div class="form-help" data-i18n-key="postItem.form.descriptionHelp">最多2000字</div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="price" class="form-label" data-i18n-key="postItem.form.priceLabel">价格 <span class="required">*</span></label>
                                <div class="price-input-group">
                                    <span class="price-symbol">¥</span>
                                    <input 
                                        type="number" 
                                        id="price" 
                                        name="price" 
                                        class="form-control" 
                                        placeholder="0.00"
                                        min="0"
                                        step="0.01"
                                        required
                                    >
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="condition" class="form-label" data-i18n-key="postItem.form.conditionLabel">物品状况 <span class="required">*</span></label>
                                <select id="condition" name="condition" class="form-control" required>
                                    <option value="" data-i18n-key="postItem.form.conditionPlaceholder">请选择状况</option>
                                    <option value="NEW" data-i18n-key="postItem.condition.new">全新</option>
                                    <option value="LIKE_NEW" data-i18n-key="postItem.condition.likeNew">几乎全新</option>
                                    <option value="GOOD" data-i18n-key="postItem.condition.good">良好</option>
                                    <option value="FAIR" data-i18n-key="postItem.condition.fair">一般</option>
                                    <option value="POOR" data-i18n-key="postItem.condition.poor">较差</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- 类别特定字段 -->
                    <div id="categoryFields" class="form-section" style="display: none;">
                        <h2 class="section-title" data-i18n-key="postItem.form.detailsInfo">详细信息</h2>
                        <div id="categoryFieldsContent">
                            <!-- 动态加载的字段 -->
                        </div>
                    </div>

                    <!-- 图片上传 -->
                    <div class="form-section">
                        <h2 class="section-title" data-i18n-key="postItem.form.imagesTitle">物品图片</h2>
                        <div class="form-group">
                            <label class="form-label" data-i18n-key="postItem.form.imagesLabel">上传图片 <span class="required">*</span></label>
                            <div class="image-upload-area">
                                <input 
                                    type="file" 
                                    id="imageInput" 
                                    accept="image/*" 
                                    multiple
                                    style="display: none;"
                                >
                                <div class="image-upload-grid" id="imagePreviewGrid">
                                    <div class="image-upload-item image-upload-placeholder" id="uploadTrigger">
                                        <div class="upload-icon">📷</div>
                                        <div class="upload-text" data-i18n-key="postItem.form.uploadText">点击上传</div>
                                        <div class="upload-hint" data-i18n-key="postItem.form.uploadHint">最多5张图片</div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-help" data-i18n-key="postItem.form.imagesHelp">支持 JPG、PNG 格式，每张图片不超过 5MB，最多上传 5 张</div>
                        </div>
                    </div>

                    <!-- 提交按钮 -->
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary btn-lg" data-i18n-key="postItem.form.submit">发布物品</button>
                        <button type="button" class="btn btn-secondary btn-lg" onclick="window.history.back()" data-i18n-key="common.actions.cancel">取消</button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <p data-i18n-key="common.footer.default">&copy; 2024 学生港湾. 保留所有权利.</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="../js/utils/i18n.data.js"></script>
    <script src="../js/utils/i18n.js"></script>
    <script src="../js/utils/auth.js"></script>
    <script src="../js/utils/navbar.js"></script>
    <script src="../js/utils/api.js"></script>
    <script src="../js/utils/navigation.js"></script>
    <script src="../js/utils/validation.js"></script>
    <script src="../js/pages/post-item.js"></script>
    <script>
        // 检查登录状态
        document.addEventListener('DOMContentLoaded', function() {
            if (!isAuthenticated()) {
                alert(I18n.t('postItem.alert.loginRequired', '请先登录后再发布物品'));
                window.location.href = 'login.html';
                return;
            }
        });
    </script>
</body>
</html>

